<html>

<head>
<title>Screenshot Website</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/static/css/normalize.css">
<link rel="stylesheet" href="/static/css/skeleton.css">
</head>
<body>
<div class="container" style="margin-top:20px;">
	<h3>Snapshot Website</h3>
	<form id="webscreenshot">
	<input name="url" type="text" size="50" placeholder="http://google.com">
	<br>
	<button id="btnScreenshot" value="Click">
		<i class="fa fa-camera-retro"></i> Snapshot
	</button>
	<div id="btnLoading" style="display:none;">
		<i class="fa fa-spinner fa-spin"></i>
	</div>
	<div id="errorText" style="display:none;"></div>
	<a id="downloadLink" target="_blank" href="" style="display:none;margin-left:10px;">
		Download Link
	</a>
	</form>
</div>

<script src="https://code.jquery.com/jquery-2.2.2.min.js" integrity="sha256-36cp2Co+/62rEAAYHLmRCPIych47CvdM+uTBJwSzWjI=" crossorigin="anonymous"></script>

<script>
$(document).ready(function(){
	$('#btnScreenshot').click(screenshot)
})

function screenshot(e){
	e.preventDefault();
	loadingButton(false)
	
	$.ajax({
        url: '/screenshot',
        type: 'get',
        dataType: 'text',
        data: $('form#webscreenshot').serialize(),
        success: onScreenshotSuccess,
		error:onScreenshotError
    });
}

function loadingButton(hide){
	$('#downloadLink').hide();
	$('#errorText').hide();
	
	if(hide){
		$('#btnScreenshot').show();
		$('#btnLoading').hide();
	}else{
		$('#btnScreenshot').hide();
		$('#btnLoading').show();
	}
}

function onScreenshotSuccess(text){
	loadingButton(true)
	
	$('#downloadLink').attr('href',text).show();
	$('#errorText').text('').hide();
}

function onScreenshotError(data){
	loadingButton(true)
	var text = data.responseText;
	$('#downloadLink').attr('href','').hide();
	$('#errorText').text(text).show();
}

</script>
</body>
</html>